(()=>{"use strict";const t=(t,e="00:00:00",n="000")=>{let i=e?Number(e.substring(0,2)):0,r=e?Number(e.substring(3,5)):0,a=e?Number(e.substring(6,8)):0,o=e&&e.length>8?Number(e.substring(9,e.length)):0;n&&(o=Number(n));let s=Number(t.substring(0,2)),l=Number(t.substring(3,5))-1,c=Number(t.substring(6,t.length));return Date.parse(new Date(c,l,s,i,r,a))+o},e=["fT","yQ","rb","st","Lo","zP","Nx","ga","uV","Hl"],n=["ak","jW","ij","fd","Oa","hw","Uh","kj","Ag","Yw"],i=["_3","7@","&6","2%","8$","0*","#9","-5","1+","!4"],r="abcdefghijklmnopqrstuvxwyz".split(""),a=[...e,...n,...i];function o(t){let e="",n="";for(let i=1;i<=t.length;i+=2)e=String(a.indexOf(t.substring(i-1,i+1))),n+=e.substring(e.length-1);return n}!async function(){var a=!1;function s(t){return new Promise(((e,n)=>setTimeout(e,t)))}function l(t,e){return Math.round(parseInt(t)+Math.random()*(e-t))}if($("form").length){var c=document.createElement("script");c.innerHTML='if (/screen=am_farm/g.test(window.location.href)) {var faTable = $("#plunder_list");function customSendUnits(e, r, t, a) {var s = a.closest("tr");if (a.closest("tr").remove(), (e = $(e)).hasClass("farm_icon_disabled")) return !1;var i = {target: r, template_id: t, source: game_data.village.id};return $.post(Accountmanager.send_units_link, i, function (e) {if (e.error) UI.ErrorMessage(e.error), $(faTable).find("tr").eq(h).before(s); else {if ($(".farm_village_" + r).addClass("farm_icon_disabled"), void 0 !== $(a).prop("tooltipText")) var t = $(a).prop("tooltipText");var i = $("<div></div>").append($(t)), n = ($(i).find(\'img[src*="res.png"]\').eq(0).attr("src"), t.split("<br />"));n.splice(n.length - 2, 1), UI.SuccessMessage(n.join(" "), 1e3), a.closest("tr").remove(), Accountmanager.farm.updateOwnUnitsAvailable(e.current_units)}}, "json"), !1}function customSendUnitsFromReport(e, r, t, a) {var s = a.closest("tr");if (a.closest("tr").remove(), (e = $(e)).hasClass("farm_icon_disabled")) return !1;var i = {report_id: t};return $.post(Accountmanager.send_units_link_from_report, i, function (e) {if (e.error) UI.ErrorMessage(e.error), $(faTable).find("tr").eq(h).before(s); else if ("string" == typeof e.success) {if (void 0 !== $(a).prop("tooltipText")) var t = $(a).prop("tooltipText");var i = $("<div></div>").append($(t)), n = ($(i).find(\'img[src*="res.png"]\').eq(0).attr("src"), t.split("<br />"));n.splice(n.length - 2, 1), UI.SuccessMessage(n.join(" "), 1e3), $(".farm_village_" + r).addClass("farm_icon_disabled"), Accountmanager.farm.updateOwnUnitsAvailable(e.current_units)}}, "json"), !1}}',document.body.appendChild(c);var d,p="",m=0,u="fakeypress",g="1.98 - Unofficial Patch by LilGhost<br/>",h="https://dsen.innogamescdn.com/asset/6052b745/graphic/",f={a:65,b:66,c:67,skip:74,right:39,left:37,master:90},b={a:!1,b:!1,c:!1,skip:!1,left:!1,right:!1},v=Object.keys(Accountmanager.farm.templates).map((t=>t.match(/\d+/g)[0])),y={a:v[0],b:v[1]},k=!1,_=0,w="";"0"!=window.game_data.player.sitter&&(w="t="+window.game_data.player.id+"&");var x,S,C,I,A=["https://"+window.location.host+"/game.php?"+w+"village=","&screen=am_farm"],R={s:{order:0,dir:1,loadp:2,fp:3,lp:4,remaxes:5,remyellow:6,remred:7,remblue:8,remgreen:9,remredy:10,remredb:11,remattsince:12,farmab:13}},O=0,T=0,F=D(),q=!0;function U(){"am_farm"!==window.game_data.screen&&tt(),$.cookie(u)?-1==$.cookie(u).indexOf("{")?(alert("Attempting to adapt existing settings to work with newer version. If there are problems with the settings transition, please try changing your cookie name.\n\n-crim"),dodokeys=$.cookie(u).split(","),Q(),S[0]=dodokeys[0],S[1]=dodokeys[1],S[2]=dodokeys[2],f.a=parseInt(S[0]),f.b=parseInt(S[1]),f.c=parseInt(S[2]),f.skip=parseInt(S[3]),f.right=parseInt(S[4]),f.left=parseInt(S[5]),B(u,180)):parseFloat($.cookie(u).split("{")[1].split("}")[0])<=1.6?(UI.ErrorMessage("Due to an update, the user data must be reset to default settings. Please redefine your settings and keys, sorry for any inconvenience<br><br>-crim",2e3),Q()):(S=$.cookie(u).split("[")[1].split("]")[0].split(","),C=$.cookie(u).split("[")[2].split("]")[0].split(","),f.a=parseInt(S[0]),f.b=parseInt(S[1]),f.c=parseInt(S[2]),f.skip=parseInt(S[3]),f.right=parseInt(S[4]),f.left=parseInt(S[5])):(UI.SuccessMessage("Welcome to FA KeyPress by Crimsoni",1e3),Q()),x=$("#plunder_list"),"1"===C[R.s.loadp]?($("#am_widget_Farm").hide(),$("#plunder_list tr:gt(0)").remove(),$("#plunder_list_nav").hide(),W()):(a=!1,X())}function D(){let t=Accountmanager.farm.current_units,e=[];for(let n in t)e.push(n);return e}function P(){function t(t){49!=d&&97!=d||!t.target||"input"==t.target.localName?50!=d&&98!=d||!t.target||"input"==t.target.localName?51!=d&&99!=d||!t.target||"input"==t.target.localName?77==d&&t.target&&"input"!=t.target.localName?window.location=game_data.link_base_pure+"map":b.a?(f.a=d,z()):b.b?(f.b=d,z()):b.c?(f.c=d,z()):b.skip?(f.skip=d,z()):b.left?(f.left=d,z()):b.right?(f.right=d,z()):d==f.skip?$(x).find("tr").eq(1).remove():d==f.c?N("c"):d==f.a?N("a"):d==f.b&&N("b"):window.location=game_data.link_base_pure+"train":window.location=game_data.link_base_pure+"main":window.location=game_data.link_base_pure+"am_farm"}window.onkeypress=function(t){_=performance.now()},window.onkeydown=function(e){_=performance.now(),d=e.keyCode?e.keyCode:e.which,k=!0,d==f.left?q&&Z("p"):d==f.right&&q&&Z("n");let n=setInterval((()=>{performance.now()-_<500?(t(),k||clearInterval(n)):clearInterval(n)}),5)},window.onkeyup=function(e){t(),k=!1}}function L(t){let e={spear:parseInt($(".unit-item.unit-item-spear").text()),sword:parseInt($(".unit-item.unit-item-sword").text()),axe:parseInt($(".unit-item.unit-item-axe").text()),spy:parseInt($(".unit-item.unit-item-spy").text()),light:parseInt($(".unit-item.unit-item-light").text()),heavy:parseInt($(".unit-item.unit-item-heavy").text())};if(null==t)return!1;for(let n of F)if(null!=t[n]&&e[n]<t[n])return!1;return!0}async function N(t){$(x).find("tr").length;let e,n,i="c"!=t?Accountmanager.farm.templates[`t_${y[t]}`]:null;for(;$(x).find("tr").eq(2).length&&!a;){if(e=$(x).find("tr").eq(2),n=$('a[class*="farm_icon_'+t+'"]',e).eq(0),null!=$(n).html()){if(!L(i)){console.log("Unidades insuficientes!"),UI.SuccessMessage("Acabou!",2e3);break}-1==$(n).attr("class").indexOf("farm_icon_disabled")&&$(n).click()}await s(l(200,250))}UI.SuccessMessage("Acabou!",2e3)}function B(t,e,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var r="expires="+i.toGMTString();document.cookie=t+"="+e+"; "+r+"; path=/"}function M(){let t=`<div id='divFAPress' class='vis' style='font-size:12px;width:40%'>\n\t\t\t\t<table id='faKeyPress' class='vis' style='width:100%' cellspacing='0'>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th colspan='8' style='font-size:16px;text-align:center'>FA Keypress v" ${g} " by\n\t\t\t\t\t\t\t\t<a href='#' id='contactme'>Crimsoni</a>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t  <tr id='buttonRow'>\n                            <th colspan='1' valign='middle'>Buttons: <img src='https://media.innogamescdn.com/com_DS_FR/Scripts/Pillage/questionmark.png' title='Clique sur un bouton puis une touche du clavier pour modifier' width='13' height='13' alt='' class='tooltip' />\n                            <td colspan='1' align='center'>\n                                <a href='#' id='buttona' class='tooltip farm_icon farm_icon_a' title='Bouton A'>\n                            <td colspan='1' align='center'>\n                                <a href='#' id='buttonb' class='tooltip farm_icon farm_icon_b' title='Bouton B'>\n                            <td colspan='1' align='center'>\n                                <a href='#' id='buttonc' class='tooltip farm_icon farm_icon_c'  title='Bouton C'>\n                            <td colspan='1' align='center'>\n                                <input class='btn tooltip' type='button' id='buttonignore' value='Ignorer' style='margin:0px 0px 0px 0px' title='Ignore la ligne de pillage'/>\n                            <td colspan='1' align='center'>\n                                <a href='#' id='buttonleft' class='tooltip ' title='<-'><-</a>\n                            <td colspan='1' align='center'>\n                                <a href='#' id='buttonright' class='tooltip ' title='->'>-></a>\n                        </tr>\n\t\t\t\t\t\t<tr id='keysRow'>\n\t\t\t\t\t\t\t<th colspan='1'>Keys:</th>\n\t\t\t\t\t\t\t<td align='center'>${String.fromCharCode(f.a)}</td>\n\t\t\t\t\t\t\t<td align='center'>${String.fromCharCode(f.b)}</td>\n\t\t\t\t\t\t\t<td align='center'>${String.fromCharCode(f.c)}</td>\n\t\t\t\t\t\t\t<td align='center'>${String.fromCharCode(f.skip)}</td>\n\t\t\t\t\t\t    <td>${String.fromCharCode(f.left)}\n                            <td>${String.fromCharCode(f.right)}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>`,e=`<table id='faKeySettings' class='vis' style='width:100%' cellspacing='0'>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th colspan='3'> <em>Settings</em> - <a href'#' id='showSettings' style='cursor:pointer;'>Hide</a> </th>\n\t\t\t\t</thead>\n\t\t\t\t<tbody id='bodySettings'>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan='1' align='center'>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbLoadPages'> <b>Load pages</b>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td colspan='2'>From\n\t\t\t\t\t\t\t<input type='text' id='txtFirstPage' size='2' maxlength='2' value='${C[R.s.fp]}'> to\n\t\t\t\t\t\t\t<input type='text' id='txtLastPage' size='2' maxlength='2' value='${C[R.s.lp]}'>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align='center'> <b>Hide</b> </td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemAxes'>\n\t\t\t\t\t\t\t<img src='${h}command/attack.png' title='Outgoing attacks' alt='' class='tooltip' />\n\t\t\t\t\t\t\tAttacks<br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemBlue'>\n\t\t\t\t\t\t\t<img src='${h}dots/blue.png' title='Scouted' alt='' class='tooltip' /> Scouted\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemGreen''>\n\t\t\t\t\t\t\t<img src=' ${h}dots/green.png' title='Complete victory' alt='' class='tooltip' />\n\t\t\t\t\t\t\tComplete victory <br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemYellow'>\n\t\t\t\t\t\t\t<img src='${h}dots/yellow.png' title='Victory, with some losses' alt='' class='tooltip' />\n\t\t\t\t\t\t\tVictory, with some losses <br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemRedYellow'>\n\t\t\t\t\t\t\t<img src='${h}dots/red_yellow.png' title='Defeated, but damaged building(s)' alt=''\n\t\t\t\t\t\t\t\tclass='tooltip' /> Defeated, but\n\t\t\t\t\t\t\tdamaged<br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemRedBlue'>\n\t\t\t\t\t\t\t<img src='${h}dots/red_blue.png' title='Defeated, but scouted' alt='' class='tooltip' />\n\t\t\t\t\t\t\tDefeated, but scouted<br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbRemRed'>\n\t\t\t\t\t\t\t<img src='${h}dots/red.png' title='Defeated' alt='' class='tooltip' /> Defeated<br>\n\t\t\t\t\t\t\t<input type='checkbox' id='chbFarmAB'>\n\t\t\t\t\t\t\t<img src='${h}max_loot/1.png' title='FarmAB' alt='' class='tooltip' /> Farm A FULL B\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align='right' colspan='2'>\n\t\t\t\t\t\t\t<input type='button' class='btn' id='btnSettingsReset' value='Reset'>\n\t\t\t\t\t\t\t<input type='button' class='btn' id='btnSettingsApply' value='Apply'>\n\t\t\t\t\t\t\t<input type='button' class='btn' id='btnSettingsSave' value='Save'>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>`;$("#divFAPress")&&($("#divFAPress").remove(),$("#divFAPressSettings").remove()),$("#contentContainer h3").eq(0).after($(t)),$("#divFAPress").append($(e)),$("#contactme").bind("click",(function(){return window.open("mailto:cchrisggrant@gmail.com")})),$("#buttona").bind("click",(function(){return H(0)})),$("#buttonb").bind("click",(function(){return H(1)})),$("#buttonc").bind("click",(function(){return H(2)})),$("#buttonignore").bind("click",(function(){return H(3)})),$("#buttonleft").bind("click",(function(){return H(4)})),$("#buttonright").bind("click",(function(){return H(5)})),$("#showSettings").bind("click",E),$("#chbLoadPages").bind("click",(function(){j($(this).is(":checked"),R.s.loadp)})),$("#chbRemAxes").bind("click",(function(){j($(this).is(":checked"),R.s.remaxes)})),$("#chbRemBlue").bind("click",(function(){j($(this).is(":checked"),R.s.remblue)})),$("#chbRemGreen").bind("click",(function(){j($(this).is(":checked"),R.s.remgreen)})),$("#chbRemYellow").bind("click",(function(){j($(this).is(":checked"),R.s.remyellow)})),$("#chbRemRedYellow").bind("click",(function(){j($(this).is(":checked"),R.s.remredy)})),$("#chbRemRedBlue").bind("click",(function(){j($(this).is(":checked"),R.s.remredb)})),$("#chbRemRed").bind("click",(function(){j($(this).is(":checked"),R.s.remred)})),$("#chbFarmAB").bind("click",(function(){j($(this).is(":checked"),R.s.farmab)})),$("#btnSettingsReset").bind("click",(function(){return Q(),UI.SuccessMessage("Settings reset",1e3),U(),!1})),$("#btnSettingsApply").bind("click",(function(){return G(),U(),!1})),$("#btnSettingsSave").bind("click",(function(){return G(),!1})),"1"===C[R.s.remred]&&$("#chbRemRed").prop("checked",!0),"1"===C[R.s.remredy]&&$("#chbRemRedYellow").prop("checked",!0),"1"===C[R.s.remredb]&&$("#chbRemRedBlue").prop("checked",!0),"1"===C[R.s.remgreen]&&$("#chbRemGreen").prop("checked",!0),"1"===C[R.s.remblue]&&$("#chbRemBlue").prop("checked",!0),"1"===C[R.s.remaxes]&&$("#chbRemAxes").prop("checked",!0),"1"===C[R.s.remyellow]&&$("#chbRemYellow").prop("checked",!0),"1"===C[R.s.farmab]&&$("#chbFarmAB").prop("checked",!0),"1"===C[R.s.loadp]&&$("#chbLoadPages").prop("checked",!0)}function j(t,e){C[e]=t?"1":"0",B(u,"{"+g+"}["+S.toString()+"]["+C.toString()+"]",180)}function G(){C[R.s.fp]=$("#txtFirstPage").val(),C[R.s.lp]=$("#txtLastPage").val(),B(u,"{"+g+"}["+S.toString()+"]["+C.toString()+"]",180),UI.SuccessMessage("Settings saved",1e3)}function E(){-1!=$("#showSettings").html().indexOf("Hide")?($("#bodySettings").hide(),$("#showSettings").html("Show")):($("#bodySettings").show(),$("#showSettings").html("Hide"))}function z(){S=[f.a,f.b,f.c,f.skip,f.right,f.left,f.master],B(u,"{"+g+"}["+S.toString()+"]["+C.toString()+"]",180),H(10),$("#divFAPress").remove(),M(),E()}function H(t){b.a=!1,b.b=!1,b.c=!1,b.skip=!1,b.left=!1,b.right=!1,0==t?b.a=!0:1==t?b.b=!0:2==t?b.c=!0:3==t?b.skip=!0:4==t?b.left=!0:5==t&&(b.right=!0)}function Y(t){var e=t.find("a").attr("onclick");if(void 0!==e){var n=e.slice(e.indexOf("(")+1,e.indexOf(")"));n.split(","),-1==e.indexOf("FromReport")?t.find("a").attr("onclick","return customSendUnits("+n+", $(this))"):t.find("a").attr("onclick","return customSendUnitsFromReport("+n+"))")}}function K(){var t=$('#plunder_list tbody tr[class^="report_"]'),e=[];for(row of t)amount_attacks=$(row).find("td:eq(3) span").text().match(/\d+/g),amount_attacks=amount_attacks?parseInt(amount_attacks[0]):0,e[amount_attacks]||(e[amount_attacks]=[]),e[amount_attacks].push(row);var n=$("#plunder_list tbody tr");n.splice(0);for(let t of n)$(t).remove();var i=Object.keys(e),r=i.length;for(let t=0;t<r;t++){var a=e[i[t]].length;for(let n=0;n<a;n++)$("#plunder_list tbody").append(e[i[t]][n])}}function W(){$("#contentContainer h3").eq(0).after("<div id='yoloLoader'><img src='graphic/throbber.gif' height='24' width='24'></img> <span id='yoloLoadText'> 0%</span></div>");var t=$("#plunder_list_nav").find("table").eq(0).find("a:last").html(),e=1;t&&(e=$.trim(t.replace(/\D+/g,""))),J(e=parseInt(e)>parseInt(C[R.s.lp])?parseInt(C[R.s.lp]):parseInt(e))}function J(t){var e=parseInt(C[R.s.fp])-1+T;$.get(A[0]+window.game_data.village.id+"&order="+C[R.s.order]+"&dir"+C[R.s.dir]+"&Farm_page="+e+"&screen=am_farm",(function(e){var n=$(e),i=$("#plunder_list",n),r=$(i).find("tr");null==I&&(I=(C[R.s.lp]-C[R.s.fp]+1)*r.length);for(var a=1;a<r.length;a++)$(x).find("tr:last").after($(r[a])),O++,$("#yoloLoadText").html(Math.round(O/I*100)+"%");++T==t?(T=0,O=0,I=null,$("#yoloLoader").remove(),$("#am_widget_Farm").show(),X()):J(t)}))}function V(){for(var t=1;t<$(x).find("tr").length;t++){var e=$(x).find("tr").eq(t);(1==C[R.s.remaxes]&&-1!=$(e).html().indexOf("attack.png")||1==C[R.s.remyellow]&&-1!=$(e).html().indexOf("yellow.png")||1==C[R.s.remredy]&&-1!=$(e).html().indexOf("red_yellow.png")||1==C[R.s.remredb]&&-1!=$(e).html().indexOf("red_blue.png")||1==C[R.s.remred]&&-1!=$(e).html().indexOf("red.png")||1==C[R.s.remgreen]&&-1!=$(e).html().indexOf("green.png")||1==C[R.s.remblue]&&-1!=$(e).html().indexOf("blue.png"))&&($(e).remove(),t--)}}function Q(){$.cookie(u,null),C=["distance","asc","0","1","1","1","0","0","0","0","0","0","0"],B(u,"{"+g+"}["+(S=[65,66,67,74,39,37,90]).toString()+"]["+C.toString()+"]",180)}async function X(){console.log("initStaf"),V(),$("#plunder_list tr:gt(0)").each((function(t){$(this).children("td").each((function(t){switch(t){case 3:var e=$(this).find("img");if(void 0!==$(e).prop("tooltipText"))(n=$(e).prop("tooltipText"))&&(n=n.replace(/\D/g,"")),$(this).find("img").after("<span style='font-weight:bold;'> ("+(n||0)+")</span>");else if(void 0!==e.attr("title")){var n;(n=e.attr("title"))&&(n=n.replace(/\D/g,"")),e.after("<span style='font-weight:bold;'> ("+(n||0)+")</span>")}break;case 8:case 9:case 10:Y($(this))}}))})),K(),$("h3").eq(0).text("Farm Assistant*"),$(".row_a").css("background-color","rgb(216, 255, 216)"),$("#plunder_list").find("tr:gt(0)").each((function(t){$(this).removeClass("row_a"),$(this).removeClass("row_b"),t%2==0?$(this).addClass("row_a"):$(this).addClass("row_b")})),$("#contentContainer").find('div[class="vis"]').eq(0).children().eq(0).append($("<div class='vis'\n\t\t\t\tstyle='float:right;text-align:center;line-height:100%;width:12px;height:12px;margin:0px 0px 0px 0px;position:relative;background-color:tan;opacity:.7'>\n\t\t\t\t<a href='#' num='0' class=\"menu_toggle\">+</a>\n\t\t\t</div>")),$("#am_widget_Farm").find("h4").eq(0).append($("<div class='vis'\n\t\t\t\tstyle='float:right;text-align:center;line-height:100%;width:12px;height:12px;margin:0px 0px 0px 0px;position:relative;background-color:tan;opacity:.7'>\n\t\t\t\t<a href='#' num='1' class=\"menu_toggle\" >+</a>\n\t\t\t</div>")),$("a.menu_toggle").bind("click",(function(){var t,e;return t=$(this),e=$("#divFAPress").length>0?1:0,"+"===$(t).text()?$(t).text("-"):$(t).text("+"),0==parseInt($(t).attr("num"))?$("#contentContainer").find('div[class="vis"]').eq(e).children().eq(1).toggle():1==parseInt($(t).attr("num"))&&$("#plunder_list_filters").toggle(),!1})),P(),M(),E(),Accountmanager.initTooltips(),L(Accountmanager.farm.templates[`t_${y.a}`])&&(console.log("Entrou a"),await N("a")),L(Accountmanager.farm.templates[`t_${y.b}`])&&(console.log("Entrou b"),await N("b")),await s(l(6e4,12e4)),window.location.reload()}function Z(t){a=!0;try{currentIncrement=m,q=!1,Timing.pause(),et(),nt();var e=A[0]+t+window.game_data.village.id+A[1];$.ajax({type:"GET",url:e,error:function(t,e){alert("Error: "+e),$("#fader").remove(),$("#loaders").remove()},success:function(t){p=t.split("TribalWars.updateGameData(")[1].split("});")[0]+"}",(p=JSON.parse(p)).village.bonus=null,TribalWars.updateGameData(p);var e=$(t),n=t.split("<title>")[1].split("</title>")[0],i=p.village.id;game_data.village.id=i,$("#header_info").html($("#header_info",e).html()),$("#topContainer").html($("#topContainer",e).html()),$("#contentContainer").html($("#contentContainer",e).html()),$("#quickbar_inner").html($("#quickbar_inner",e).html()),$("head").find("title").html(n),$("#fader").remove(),$("#loaders").remove(),q=!0,Timing.resetTickHandlers(),Timing.pause(),m++,U()}})}catch(t){}}function tt(){et(),nt();var t=A[0]+window.game_data.village.id+A[1];$.getScript("https://"+window.location.host+"/js/game/Accountmanager.js",(function(){$.ajax({type:"GET",url:t,error:async function(t,e){$("#fader").remove(),$("#loaders").remove(),await s(l(3e4,6e4)),window.location.reload()},success:function(t){var e=$(t),n=t.split("<title>")[1].split("</title>")[0],i=window.top.$.parseJSON(t.split("TribalWars.updateGameData(")[1].split(");")[0]);window.top.game_data=i,$("#header_info").html($("#header_info",e).html()),$("#topContainer").html($("#topContainer",e).html()),$("#contentContainer").html($("#contentContainer",e).html()),$("head").find("title").html(n),$("#fader").remove(),$("#loaders").remove(),U()}})}))}function et(){var t=document.createElement("div");t.id="fader",t.style.position="fixed",t.style.height="100%",t.style.width="100%",t.style.backgroundColor="black",t.style.top="0px",t.style.left="0px",t.style.opacity="0.6",t.style.zIndex="12000",document.body.appendChild(t)}function nt(){var t=m,e=document.createElement("div");e.id="loaders",e.style.position="fixed",e.style.width="24px",e.style.height="24px",e.style.top="50%",e.style.left="50%",$(e).css("margin-left","-12px"),$(e).css("margin-top","-12px"),e.style.zIndex=13e3,$(e).append($("<img src='graphic/throbber.gif' height='24' width='24'></img>")),$("#contentContainer").append($(e)),setTimeout((function(){if(m<=t){UI.ErrorMessage("Un problÃƒÆ’Ã‚Â¨me a ÃƒÆ’Ã‚Â©tÃƒÆ’Ã‚Â© rencontrÃƒÆ’Ã‚Â©, la page va se recharger.");var e=document.URL.split("village=")+"village="+game_data.village.id+"&screen=am_farm";window.location.href=e,console.log("La page a mis trop de temps ÃƒÆ’  se charger.")}}),4e3)}if(!localStorage.keyGO)return;if(!JSON.parse(localStorage.keyGO).key)return;(function(a){let s=!0,l=document.querySelector("#serverDate").textContent,c=document.querySelector("#serverTime").textContent,d=a.split("="),p=d[0].split("_")[0];s=!0===s&&p==game_data.world;let m=d[0].split("_")[1];s=!0===s&&m==game_data.player.name;let u=d[2].split(":"),g=u[0];s=!0===s&&o(g)==p.match(/[0-9]/gi).reduce(((t,e)=>t+e),"");let h=u[1],f=u[2].split(".")[0];s=!0===s&&f==function(t){let e=t.toLowerCase().split(""),n="",i=1;for(let t=0;t<e.length&&!(-1!=r.indexOf(e[t])&&(n+=r.indexOf(e[t]),i++,i>3));t++);return n}(m);let b=u[2].split(".")[1];s=!0===s&&b==function(t){let a=t.split(""),o="";for(let t=0;t<a.length;t++)o+=String(r.indexOf(a[t]));a=o.split("");let s="";for(let t=0;t<a.length;t++)-1!=[0,3,6].indexOf(t)&&(s+=e[a[t]]),-1!=[1,4,7].indexOf(t)&&(s+=n[a[t]]),-1!=[2,5,8].indexOf(t)&&(s+=i[a[t]]);return s}(p.match(/[a-z]/gi).reduce(((t,e)=>t+e),""));let $=u[3];return s=!0===s&&t(l,c)<t(new Date(Number(o($)+o(h)+"00000")).toLocaleDateString(),new Date(Number(o($)+o(h)+"00000")).toLocaleTimeString()),s})(JSON.parse(localStorage.keyGO).key)&&U()}}()})();
