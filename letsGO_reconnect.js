(()=>{"use strict";const e=(e,t)=>Math.floor(Math.random()*(Math.floor(t)-Math.ceil(e)+1))+Math.ceil(e),t=JSON.parse(localStorage.getItem("players")),r=document.referrer.split(".")[0].split("//")[1],n=Array.from(document.querySelectorAll("#home > div.center > div.content.box-border.red > div.inner > div.right.login > div.wrap > div:nth-child(4) input")),l=n.map((e=>e.checked)),o=document.querySelector("#reconnectAll"),c=()=>{console.log("ref: "+r),t[u][r]?setTimeout((()=>{1==t[u][r].reconnect&&(self.location=t[u][r].href)}),e(1e3,1e4)+6e4):setTimeout((()=>window.history.go(-1)),e(1e3,1e4)+3e4)};function i(e){"checkbox"==e.target.attributes[0].value&&(e=>{if("reconnectAll"==e.target.id){n.forEach((t=>t.checked=e.target.checked));for(const r in t[u])Object.hasOwnProperty.call(t[u],r)&&(t[u][r].reconnect=e.target.checked)}else t[u][e.target.name].reconnect=e.target.checked,o.checked=a(l);localStorage.setItem("players",JSON.stringify(t))})(e),c()}const a=e=>!(e.reduce(((e,t)=>e+(0==t?1:0)),0)>=e.length/2),s=document.querySelector("#home div.right.login div.wrap"),u="Login"!=s.querySelector("h2").innerText&&s.querySelector("h2").innerText.split(" ")[1];localStorage.players||localStorage.setItem("players",JSON.stringify({}));const g=JSON.parse(localStorage.getItem("players"));g[u]||(g[u]={});const d=(e,t="00:00:00",r="000")=>{let n=t?Number(t.substring(0,2)):0,l=t?Number(t.substring(3,5)):0,o=t?Number(t.substring(6,8)):0,c=t&&t.length>8?Number(t.substring(9,t.length)):0;r&&(c=Number(r));let i=Number(e.substring(0,2)),a=Number(e.substring(3,5))-1,s=Number(e.substring(6,e.length));return Date.parse(new Date(s,a,i,n,l,o))+c},h=["fT","yQ","rb","st","Lo","zP","Nx","ga","uV","Hl"],p=["ak","jW","ij","fd","Oa","hw","Uh","kj","Ag","Yw"],m=["_3","7@","&6","2%","8$","0*","#9","-5","1+","!4"],f="abcdefghijklmnopqrstuvxwyz".split(""),b=[...h,...p,...m];function y(e){let t="",r="";for(let n=1;n<=e.length;n+=2)t=String(b.indexOf(e.substring(n-1,n+1))),r+=t.substring(t.length-1);return r}localStorage.keyGO&&JSON.parse(localStorage.keyGO).key&&function(e){let t=!0,r=(new Date).toLocaleDateString(),n=(new Date).toLocaleTimeString(),l=e.split("="),o=l[0].split("_")[0],c=l[0].split("_")[1];if(!u)return!1;t=!0===t&&c==u;let i=l[2].split(":"),a=i[1],s=i[2].split(".")[0];t=!0===t&&s==function(e){let t=e.toLowerCase().split(""),r="",n=1;for(let e=0;e<t.length&&!(-1!=f.indexOf(t[e])&&(r+=f.indexOf(t[e]),n++,n>3));e++);return r}(c);let g=!!i[2].split(".")[1]&&g==function(e){let t=e.split(""),r="";for(let e=0;e<t.length;e++)r+=String(f.indexOf(t[e]));t=r.split("");let n="";for(let e=0;e<t.length;e++)-1!=[0,3,6].indexOf(e)&&(n+=h[t[e]]),-1!=[1,4,7].indexOf(e)&&(n+=p[t[e]]),-1!=[2,5,8].indexOf(e)&&(n+=m[t[e]]);return n}(o.match(/[a-z]/gi).reduce(((e,t)=>e+t),"")),b=i[3];return t=!0===t&&d(r,n)<d(new Date(Number(y(b)+y(a)+"00000")).toLocaleDateString(),new Date(Number(y(b)+y(a)+"00000")).toLocaleTimeString()),t}(JSON.parse(localStorage.keyGO).key)&&u&&(function(){const e=Array.from(document.querySelector("#home div.worlds-container").querySelectorAll("a")),t=e.map((e=>e.children[0].innerText)),r=e.map((e=>e.attributes[1].value.split("/")[3])),n=e.map((e=>e.attributes[1].value)),l=[];for(let e=0;e<r.length;e++)g[u][r[e]]||(g[u][r[e]]={},g[u][r[e]].href=n[e],g[u][r[e]].reconnect=!1),l.push(g[u][r[e]].reconnect),localStorage.setItem("players",JSON.stringify(g));for(let n=0;n<e.length;n++)e[n].innerHTML=`<div style="display: inline-flex;"><label for="r_${r[n]}" title="Select to reconnect this world" style="width: 15%; height: 12px; margin-right: 3px;"><input type="checkbox" name="${r[n]}" id="r_${r[n]}" ${1==g[u][r[n]].reconnect?"checked":""}></label><span class="world_button_active">${t[n]}</span></div>`;const o=document.createElement("div");s.append(o),o.className="worlds-container",o.innerHTML=`<label for="reconnectAll" style="font-weight: bold; color: brown;" title="Select to reconnect all worlds" ><input type="checkbox" name="reconnectAll" id="reconnectAll" ${1==a(l)?"checked":""} > Reconnect all</label>`,document.addEventListener("click",i)}(),c())})();
